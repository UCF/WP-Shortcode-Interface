var WPSCIF;!function(t){var e=function(){function t(){var t=this;this.$toggle=jQuery("#add-shortcode"),this.$interface=jQuery("#wp-scif-form-inner"),this.$submitBtn=this.$interface.find("#wp-scif-submit"),this.$select=this.$interface.find("#wp-scif-select"),this.selectedShortcode=null,this.$activeShortcodeEditor=null,this.$activeShortcodeDescription=null,this.$activeFields=null,this.$toggle.click(function(e){t.resetForm()}),this.$submitBtn.click(function(e){t.onSubmitBtnClick(e)}),this.$select.change(function(e){t.onSelectChanged(e)})}return t.prototype.resetForm=function(){this.editor=tinyMCE.activeEditor?tinyMCE.activeEditor:null,this.$select.val("").trigger("change"),this.$activeFields&&(this.$activeFields.prop("checked",!1),this.$activeFields.each(function(t,e){var i=jQuery(e);"checkbox"!==i.prop.type&&i.val("")}))},t.prototype.validateForm=function(){var t=0;return this.$activeFields?this.$activeFields.each(function(e,i){var o=jQuery(i),r=o.data("scif-param");o.data("scif-required")&&""===o.val()?(jQuery("."+r+"-error").addClass("active"),t++):jQuery("."+r+"-error").removeClass("active")}):t++,!t},t.prototype.parseShortcode=function(){var t=this.getFormValues();this.insertShortcode(t)},t.prototype.getFormValues=function(){var t={command:this.selectedShortcode,params:{},allowsContent:void 0!==this.$activeShortcodeEditor.data("scif-allows-content")};return this.$activeFields.each(function(e,i){var o=jQuery(i),r=o.data("scif-param"),c="";switch(o.prop("tagName")){case"INPUT":case"TEXTAREA":case"SELECT":if("checkbox"===o.prop("type"))if(o.hasClass("checkbox-list-item")){if(!o.prop("checked"))break;c=o.val()}else c=String(o.prop("checked"));else c=o.val();break;default:c=o.val()}c&&(void 0!==t.params[r]?t.params[r]+=","+c:t.params[r]=c)}),t},t.prototype.insertShortcode=function(t){var e=this.buildShortcode(t);send_to_editor(e)},t.prototype.buildShortcode=function(t){var e=null;this.editor&&(e=this.editor.selection.getContent());var i="["+t.command;if(t.params)for(var o in t.params)i+=" "+o+'="'+t.params[o]+'"';return i+="]",e&&(i+=e),t.allowsContent&&(i+="[/"+t.command+"]"),i},t.prototype.onSubmitBtnClick=function(t){t.preventDefault(),this.validateForm()&&this.parseShortcode()},t.prototype.onSelectChanged=function(t){this.selectedShortcode=this.$select.val(),this.$activeShortcodeEditor&&this.$activeShortcodeEditor.removeClass("active"),this.$activeShortcodeDescription&&this.$activeShortcodeDescription.removeClass("active");var e=this.$interface.find(".shortcode-"+this.selectedShortcode).addClass("active");this.$activeShortcodeEditor=e.filter(".shortcode-editor"),this.$activeShortcodeDescription=e.filter(".shortcode-desc"),this.$activeFields=this.$activeShortcodeEditor.find(".wp-scif-field"),this.initPreview()},t.prototype.initPreview=function(){var t=this,e=this.getFormValues();if(e.command){var i=this.buildShortcode(e);jQuery.getJSON(ajaxurl,{action:"render_shortcode",shortcode:i},function(e){var i=document.getElementById(t.selectedShortcode+"-preview");i=i.contentWindow||i.contentDocument.document||i.contentDocument,i.document.open(),i.document.write(e.markup),i.document.close()})}},t}();t.ShortcodeInterface=e}(WPSCIF||(WPSCIF={})),"undefined"!=typeof jQuery&&jQuery(document).ready(function(){new WPSCIF.ShortcodeInterface});
//# sourceMappingURL=wp-scif.min.js.map
