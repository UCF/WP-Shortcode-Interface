var WPSCIF;!function(e){var t=function(){function e(){var e=this;this.$toggle=jQuery("#add-shortcode"),this.$submitBtn=jQuery("#wp-scif-submit"),this.$select=jQuery("#wp-scif-select"),this.selectedShortcode=null,this.$fields=jQuery(".wp-scif-field"),this.$toggle.click(function(t){e.resetForm()}),this.$submitBtn.click(function(t){e.onSubmitBtnClick(t)}),this.$select.change(function(t){e.onSelectChanged(t)})}return e.prototype.resetForm=function(){this.editor=tinyMCE.activeEditor?tinyMCE.activeEditor:null,this.$select.val("").trigger("change"),this.$fields.prop("checked",!1),this.$fields.each(function(e,t){var o=jQuery(t);"checkbox"!==o.prop.type&&o.val("")})},e.prototype.validateForm=function(){var e=0;return this.$fields.each(function(t,o){var r=jQuery(o),i=r.data("scif-param");r.data("scif-required")&&""===r.val()?(jQuery("."+i+"-error").addClass("active"),e++):jQuery("."+i+"-error").removeClass("active")}),!e},e.prototype.parseShortcode=function(){var e=this.getFormValues();this.insertShortcode(e)},e.prototype.getFormValues=function(){var e={command:this.selectedShortcode,params:{}};return this.$fields.each(function(t,o){var r=jQuery(o),i=r.data("scif-param"),c="";switch(r.prop("tagName")){case"INPUT":case"TEXTAREA":case"SELECT":if("checkbox"===r.prop("type"))if(r.hasClass("checkbox-list-item")){if(!r.prop("checked"))break;c=r.val()}else c=String(r.prop("checked"));else c=r.val();break;default:c=r.val()}c&&(void 0!==e.params[i]?e.params[i]+=","+c:e.params[i]=c)}),e},e.prototype.insertShortcode=function(e){var t=this.buildShortcode(e);send_to_editor(t)},e.prototype.buildShortcode=function(e){var t=null;this.editor&&(t=this.editor.selection.getContent());var o="["+e.command;if(e.params)for(var r in e.params)o+=" "+r+'="'+e.params[r]+'"';return o+="]",t&&(o+=t+"[/"+e.command+"]"),o},e.prototype.onSubmitBtnClick=function(e){e.preventDefault();var t=this.$select.val();jQuery(".shortcode-"+t).find(".wp-scif-field");this.validateForm()&&this.parseShortcode()},e.prototype.onSelectChanged=function(e){this.selectedShortcode=this.$select.val(),0===this.selectedShortcode.length&&jQuery("#wp-scif-form-inner .active").removeClass("active"),jQuery(".shortcode-"+this.selectedShortcode).addClass("active"),this.initPreview()},e.prototype.initPreview=function(){var e=this,t=this.getFormValues();if(t.command){var o=this.buildShortcode(t);jQuery.getJSON(ajaxurl,{action:"render_shortcode",shortcode:o},function(t){var o=document.getElementById(e.selectedShortcode+"-preview");o=o.contentWindow||o.contentDocument.document||o.contentDocument,o.document.open(),o.document.write(t.markup),o.document.close()})}},e}();e.ShortcodeInterface=t}(WPSCIF||(WPSCIF={})),"undefined"!=typeof jQuery&&jQuery(document).ready(function(){new WPSCIF.ShortcodeInterface});
//# sourceMappingURL=wp-scif.min.js.map
