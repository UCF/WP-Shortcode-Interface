var WPSCIF;!function(t){!function(t){var e=function(){function t(t){this.$field=t,this.required=this.$field.data("scif-required"),void 0===this.required&&(this.required=!1),this.param=this.$field.data("scif-param")}return t.prototype.is_valid=function(){return!(this.required&&!this.get_value())},t.prototype.get_value=function(){return this.$field.val()},t.prototype.get_output=function(){return this.param+'="'+this.get_value()+'"'},t}();t.Field=e}(t.Fields||(t.Fields={}))}(WPSCIF||(WPSCIF={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),WPSCIF;!function(t){!function(t){var e=function(t){function e(e){var i=t.call(this,e)||this;return i.inputMask=i.$field.data("wpscif-valid-regex"),i}return __extends(e,t),e.prototype.is_valid=function(){t.prototype.is_valid.call(this);return new RegExp(this.inputMask).test(this.get_value())},e}(t.Field);t.TextField=e}(t.Fields||(t.Fields={}))}(WPSCIF||(WPSCIF={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),WPSCIF;!function(t){!function(t){var e=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e}(t.Field);t.SelectField=e}(t.Fields||(t.Fields={}))}(WPSCIF||(WPSCIF={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),WPSCIF;!function(t){!function(t){var e=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e}(t.Field);t.DateField=e}(t.Fields||(t.Fields={}))}(WPSCIF||(WPSCIF={}));var WPSCIF;!function(t){var e=function(){function e(e){var i=this;this.command=e,this.$container=jQuery(".shortcode-editor.shortcode-"+e),this.fields=new Array,this.$container.find(".wp-scif-field").each(function(e,r){var o=jQuery(r);i.fields.push(new t.Fields.TextField(o))})}return e.prototype.createField=function(e){var i=jQuery(e),r=i.prop("tagName");if("SELECT"===r)return new t.Fields.SelectField(i);if("INPUT"===r){switch(i.attr("type")){case"text":return new t.Fields.TextField(i);case"date":return new t.Fields.DateField(i);default:return new t.Fields.TextField(i)}}},e.prototype.getFields=function(){return this.fields},e}();t.FieldSet=e}(WPSCIF||(WPSCIF={}));var WPSCIF;!function(t){var e=function(){function t(){var t=this;this.$toggle=jQuery("#add-shortcode"),this.$submitBtn=jQuery("#wp-scif-submit"),this.$select=jQuery("#wp-scif-select"),this.selectedShortcode=null,this.$fields=jQuery(".wp-scif-field"),this.$toggle.click(function(e){t.resetForm()}),this.$submitBtn.click(function(e){t.onSubmitBtnClick(e)}),this.$select.change(function(e){t.onSelectChanged(e)})}return t.prototype.resetForm=function(){this.editor=tinyMCE.activeEditor?tinyMCE.activeEditor:null,this.$select.val("").trigger("change"),this.$fields.prop("checked",!1),this.$fields.each(function(t,e){var i=jQuery(e);"checkbox"!==i.prop.type&&i.val("")})},t.prototype.validateForm=function(){var t=0;return this.$fields.each(function(e,i){var r=jQuery(i),o=r.data("scif-param");r.data("scif-required")&&""===r.val()?(jQuery("."+o+"-error").addClass("active"),t++):jQuery("."+o+"-error").removeClass("active")}),!t},t.prototype.parseShortcode=function(){var t=this.getFormValues();this.insertShortcode(t)},t.prototype.getFormValues=function(){var t={command:this.selectedShortcode,params:{}};return this.$fields.each(function(e,i){var r=jQuery(i),o=r.data("scif-param"),n="";switch(r.prop("tagName")){case"INPUT":case"TEXTAREA":case"SELECT":if("checkbox"===r.prop("type"))if(r.hasClass("checkbox-list-item")){if(!r.prop("checked"))break;n=r.val()}else n=String(r.prop("checked"));else n=r.val();break;default:n=r.val()}n&&(void 0!==t.params[o]?t.params[o]+=","+n:t.params[o]=n)}),t},t.prototype.insertShortcode=function(t){var e=this.buildShortcode(t);send_to_editor(e)},t.prototype.buildShortcode=function(t){var e=null;this.editor&&(e=this.editor.selection.getContent());var i="["+t.command;if(t.params)for(var r in t.params)i+=" "+r+'="'+t.params[r]+'"';return i+="]",e&&(i+=e+"[/"+t.command+"]"),i},t.prototype.onSubmitBtnClick=function(t){t.preventDefault();var e=this.$select.val();jQuery(".shortcode-"+e).find(".wp-scif-field");this.validateForm()&&this.parseShortcode()},t.prototype.onSelectChanged=function(t){this.selectedShortcode=this.$select.val(),0===this.selectedShortcode.length&&jQuery("#wp-scif-form-inner .active").removeClass("active"),jQuery(".shortcode-"+this.selectedShortcode).addClass("active"),this.initPreview()},t.prototype.initPreview=function(){var t=this,e=this.getFormValues();if(e.command){var i=this.buildShortcode(e);jQuery("head",window.frames[this.selectedShortcode+"-preview"]).append("Hello world"),jQuery.getJSON(ajaxurl,{action:"render_shortcode",shortcode:i},function(e){var i=document.getElementById(t.selectedShortcode+"-preview");i=i.contentWindow||i.contentDocument.document||i.contentDocument,i.document.open(),i.document.write(e.markup),i.document.close()})}},t}();t.ShortcodeInterface=e}(WPSCIF||(WPSCIF={})),"undefined"!=typeof jQuery&&jQuery(document).ready(function(){new WPSCIF.ShortcodeInterface});
//# sourceMappingURL=wp-scif.min.js.map
