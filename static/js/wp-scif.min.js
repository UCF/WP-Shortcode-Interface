var WPSCIF;!function(t){!function(t){var e=function(){function t(t){this.$field=t,this.required=this.$field.data("scif-required"),void 0===this.required&&(this.required=!1),this.param=this.$field.data("scif-param")}return t.prototype.is_valid=function(){return!(this.required&&!this.get_value())},t.prototype.get_value=function(){return this.$field.val()},t.prototype.get_output=function(){return this.param+'="'+this.get_value()+'"'},t}();t.Field=e}(t.Fields||(t.Fields={}))}(WPSCIF||(WPSCIF={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),WPSCIF;!function(t){!function(t){var e=function(t){function e(e){var i=t.call(this,e)||this;return i.inputMask=i.$field.data("wpscif-valid-regex"),i}return __extends(e,t),e.prototype.is_valid=function(){t.prototype.is_valid.call(this);return new RegExp(this.inputMask).test(this.get_value())},e}(t.Field);t.TextField=e}(t.Fields||(t.Fields={}))}(WPSCIF||(WPSCIF={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),WPSCIF;!function(t){!function(t){var e=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e}(t.Field);t.SelectField=e}(t.Fields||(t.Fields={}))}(WPSCIF||(WPSCIF={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),WPSCIF;!function(t){!function(t){var e=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e}(t.Field);t.DateField=e}(t.Fields||(t.Fields={}))}(WPSCIF||(WPSCIF={}));var WPSCIF;!function(t){var e=function(){function e(e){var i=this;this.command=e,this.$container=jQuery(".shortcode-editor.shortcode-"+e),this.fields=new Array,this.$container.find(".wp-scif-field").each(function(e,o){var r=jQuery(o);i.fields.push(new t.Fields.TextField(r))})}return e.prototype.createField=function(e){var i=jQuery(e),o=i.prop("tagName");if("SELECT"===o)return new t.Fields.SelectField(i);if("INPUT"===o){switch(i.attr("type")){case"text":return new t.Fields.TextField(i);case"date":return new t.Fields.DateField(i);default:return new t.Fields.TextField(i)}}},e.prototype.getFields=function(){return this.fields},e}();t.FieldSet=e}(WPSCIF||(WPSCIF={}));var WPSCIF;!function(t){var e=function(){function t(){var t=this;this.$toggle=jQuery("#add-shortcode"),this.$interface=jQuery("#wp-scif-form-inner"),this.$submitBtn=this.$interface.find("#wp-scif-submit"),this.$select=this.$interface.find("#wp-scif-select"),this.selectedShortcode=null,this.$activeShortcodeEditor=null,this.$activeShortcodeDescription=null,this.$activeFields=null,this.$toggle.click(function(e){t.resetForm()}),this.$submitBtn.click(function(e){t.onSubmitBtnClick(e)}),this.$select.change(function(e){t.onSelectChanged(e)})}return t.prototype.resetForm=function(){this.editor=tinyMCE.activeEditor?tinyMCE.activeEditor:null,this.$select.val("").trigger("change"),this.$activeFields&&(this.$activeFields.prop("checked",!1),this.$activeFields.each(function(t,e){var i=jQuery(e);"checkbox"!==i.prop.type&&i.val("")}))},t.prototype.validateForm=function(){var t=0;return this.$activeFields?this.$activeFields.each(function(e,i){var o=jQuery(i),r=o.data("scif-param");o.data("scif-required")&&""===o.val()?(jQuery("."+r+"-error").addClass("active"),t++):jQuery("."+r+"-error").removeClass("active")}):t++,!t},t.prototype.parseShortcode=function(){var t=this.getFormValues();this.insertShortcode(t)},t.prototype.getFormValues=function(){var t={command:this.selectedShortcode,params:{},allowsContent:void 0!==this.$activeShortcodeEditor.data("scif-allows-content")};return this.$activeFields.each(function(e,i){var o=jQuery(i),r=o.data("scif-param"),n="";switch(o.prop("tagName")){case"INPUT":case"TEXTAREA":case"SELECT":if("checkbox"===o.prop("type"))if(o.hasClass("checkbox-list-item")){if(!o.prop("checked"))break;n=o.val()}else n=String(o.prop("checked"));else n=o.val();break;default:n=o.val()}n&&(void 0!==t.params[r]?t.params[r]+=","+n:t.params[r]=n)}),t},t.prototype.insertShortcode=function(t){var e=this.buildShortcode(t);send_to_editor(e)},t.prototype.buildShortcode=function(t){var e=null;this.editor&&(e=this.editor.selection.getContent());var i="["+t.command;if(t.params)for(var o in t.params)i+=" "+o+'="'+t.params[o]+'"';return i+="]",e&&(i+=e),t.allowsContent&&(i+="[/"+t.command+"]"),i},t.prototype.onSubmitBtnClick=function(t){t.preventDefault(),this.validateForm()&&this.parseShortcode()},t.prototype.onSelectChanged=function(t){this.selectedShortcode=this.$select.val(),this.$activeShortcodeEditor&&this.$activeShortcodeEditor.removeClass("active"),this.$activeShortcodeDescription&&this.$activeShortcodeDescription.removeClass("active");var e=this.$interface.find(".shortcode-"+this.selectedShortcode).addClass("active");this.$activeShortcodeEditor=e.filter(".shortcode-editor"),this.$activeShortcodeDescription=e.filter(".shortcode-desc"),this.$activeFields=this.$activeShortcodeEditor.find(".wp-scif-field"),this.initPreview()},t.prototype.initPreview=function(){var t=this,e=this.getFormValues();if(e.command){var i=this.buildShortcode(e);jQuery("head",window.frames[this.selectedShortcode+"-preview"]).append("Hello world"),jQuery.getJSON(ajaxurl,{action:"render_shortcode",shortcode:i},function(e){var i=document.getElementById(t.selectedShortcode+"-preview");i=i.contentWindow||i.contentDocument.document||i.contentDocument,i.document.open(),i.document.write(e.markup),i.document.close()})}},t}();t.ShortcodeInterface=e}(WPSCIF||(WPSCIF={})),"undefined"!=typeof jQuery&&jQuery(document).ready(function(){new WPSCIF.ShortcodeInterface});
//# sourceMappingURL=wp-scif.min.js.map
